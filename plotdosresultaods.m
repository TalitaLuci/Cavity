clc; clearvars; 

% Dados fornecidos Ghia


y_ghia = [1.0, 0.9766, 0.9688, 0.9609, 0.9531, 0.8516, 0.7344, 0.6172, 0.5, ...
     0.4531, 0.2813, 0.1719, 0.1016, 0.0703, 0.0625, 0.0547, 0.0];
% u_ghia = [1.0, 0.84123, 0.78871, 0.73722, 0.68717, 0.23151, ...
%         0.00332, -0.13641, -0.20581, -0.21090, -0.15662, -0.10150, ...
%        -0.06434, -0.04775, -0.04192, -0.03717, 0.0]; %Re=100
u_ghia = [1.0, 0.47221, 0.47783, 0.48070, 0.47804, 0.34635, 0.20673, 0.08344, ...
    0.03111, -0.07540, -0.23186, -0.32709, -0.38000, -0.41657, ...
     -0.42537, -0.42735, 0.0]; %Re = 10000
 x_ghia = [1.0, 0.9688, 0.9609, 0.9531, 0.9453, 0.9063, 0.8594, 0.8047, ...
      0.5, 0.2344, 0.2266, 0.1563, 0.0938, 0.0781, 0.0703, 0.0625, 0.0];
 v_ghia = [0.0, -0.54302, -0.52987, -0.49099, -0.45863, -0.41496, -0.36737, ...
     -0.30719, 0.00831, 0.27224, 0.28003, 0.35070, 0.41487, ...
     0.43124, 0.43733, 0.43983, 0.0]; %Re = 10000
% v_ghia = [0.0, -0.05906, -0.07391, -0.08864, -0.10313, -0.16914, -0.22445, ...
%    -0.24533, 0.05454, 0.17527, 0.17507, 0.16077, 0.12317, 0.10890, ...
%    0.10091, 0.09233, 0.0]; %Re=100


% dados obtidos para Re 100 e high order
% ux_plot = [0, -0.000340204686492700, -0.000670114723474284, -0.000989493223958940, -0.00129919712872468, ...
%     -0.00160004891512908, -0.00189283534543232, -0.00217830655346657, -0.00245717482174998, ...
%     -0.00273011366596030, -0.00299775742926098, -0.00326070138974660, -0.00351950227483697, ...
%     -0.00377467903385092, -0.00402671371950983, -0.00427605235165119, -0.00452310566837678, ...
%     -0.00476824970252061, -0.00501182614989862, -0.00525414251824818, -0.00549547206184711, ...
%     -0.00573605351728800, -0.00597609066199127, -0.00621575172005377, -0.00645516864108777, -0.00669443627772489, ...
%     -0.00693361148706727, -0.00717271218098872, -0.00741171635003515, -0.00765056108582523, -0.00788914162730764, ...
%     -0.00812731045690524, -0.00836487647340043, -0.00860160426926362, -0.00883721354091627, ...
%     -0.00907137866105368, -0.00930372844254422, -0.00953384612350875, -0.00976126960289587, -0.00998549195515347,...
%     -0.0102059622513996, -0.0104220867127782, -0.0106332302194104, -0.0108387181954801, -0.0110378388875206, ...
%     -0.0112298460488669, -0.0114139620385236, -0.0115893813373846, -0.0117552744788512, -0.0119107923845022, ...
%     -0.0120550710886192, -0.0121872368281753, -0.0123064114674494, -0.0124117182188731, -0.0125022876141806, ...
%     -0.0125772636726045, -0.0126358102058722, -0.0126771171933278, -0.0127004071547788, -0.0127049414438367, ...
%     -0.0126900263807452, -0.0126550191411003, -0.0125993333155995, -0.0125224440560780, -0.0124238927246611, ...
%     -0.0123032909658683, -0.0121603241259160, -0.0119947539491715, -0.0118064204885689,	-0.0115952431745989, ...
%     -0.0113612209959870, -0.0111044317540778, -0.0108250303619142, -0.0105232461676899, -0.0101993792902622, ...
%     -0.00985379596137704, -0.00948692287477352, -0.00909924054605934, -0.00869127568883169, -0.00826359261170244,...
%     -0.00781678363742985, -0.00735145853916043, -0.00686823297979385, -0.00636771592882104, -0.00585049601689527,...
%     -0.00531712677233690, -0.00476811066639554, -0.00420388187634518, -0.00362478765860579, -0.00303106820969713,...
%     -0.00242283488296262, -0.00180004662620402, -0.00116248451269781, -0.000509724259190897, 0.000158893336331420,...
%     0.000844294042174395, 0.00154770384033296, 0.00227068436364125, 0.00301516974766938, 0.00378350431142215, ...
%     0.00457848021870573, 0.00540337395472680, 0.00626198007836653, 0.00715864028116722, 0.00809826530542197, ...
%     0.00908634675775471, 0.0101289553205748, 0.0112327213400322, 0.0124047932941598, 0.0136527692686965, ...
%     0.0149845963524226, 0.0164084328819547, 0.0179324688011222, 0.0195647001425843, 0.0213126548820035, ...
%     0.0231830692465909, 0.0251815160565169, 0.0273119898935747, 0.0295764578473919, 0.0319743892621333, ...
%     0.0345022832197444, 0.0371532183153533,	0.0399164554177774,	0.0427771303340900,	0.0457160793703882,...
%     0.0487098465249412, 0.0517309258222215,	0.0547483066849680,	0.0577350269189626]; 
% 
% uy_plot=[0.0, 0.000853698510822780, 0.00166630218091483, 0.00243424648105105, 0.00315836479244241, 0.00383961478721800,...
%     0.00447906138131003, 0.00507786083411050, 0.00563724533132045, 0.00615850807600962, 0.00664298894419879,...
%     0.00709206078922892, 0.00750711648330848, 0.00788955677589681, 0.00824077903346211, 0.00856216690790589,...
%     0.00885508096405510, 0.00912085028130686, 0.00936076503118316, 0.00957607002116960, 0.00976795918551252,...
%     0.00993757099534135, 0.0100859847532932, 0.0102142177315770, 0.0103232231070226, 0.0104138886420766,...
%     0.0104870360569648, 0.0105434210353464, 0.0105837338037973, 0.0106086002243808, 0.0106185833393971,...
%     0.0106141853081237, 0.0105958496769079, 0.0105639639262844, 0.0105188622417659, 0.0104608284585006,...
%     0.0103900991339877, 0.0103068667073865, 0.0102112827085399, 0.0101034609845381, 0.00998348091640505,...
%     0.00985139060318277, 0.00970720999526153, 0.00955093396318217, 0.00938253529227485, 0.00920196759735008,...
%     0.00900916815520080, 0.00880406065588498, 0.00858655787663579, 0.00835656428478736, 0.00811397857832099,...
%     0.00785869617455091, 0.00759061165909169, 0.00730962120862014, 0.00701562500208138, 0.00670852963592976,...
%     0.00638825055976053, 0.00605471454931747, 0.00570786223435967, 0.00534765069928048, 0.00497405617467412,...
%     0.00458707683827882, 0.00418673574384752, 0.00377308389652281, 0.00334620349316803, 0.00290621134580394,...
%     0.00245326250574753, 0.00198755410518964, 0.00150932943166621, 0.00101888224908498, 0.000516561376522165,...
%     2.77553276784895e-06, -0.000522001549605586, -0.00105722574220688, -0.00160227687904706, -0.00215645287143124,...
%     -0.00271896360585870, -0.00328892466309916, -0.00386535091055050, -0.00444715003612947, -0.00503311611041575,...
%     -0.00562192328455500, -0.00621211975443483, -0.00680212214666756, -0.00739021050855494, -0.00797452411190323,...
%     -0.00855305830850694, -0.00912366270228107, -0.00968404092807997, -0.0102317523486019, -0.0107642159965993,...
%     -0.0112787170977857, -0.0117724165080989, -0.0122423633849765, -0.0126855113837292, -0.0130987386248040,...
%     -0.0134788716140261, -0.0138227132146170, -0.0141270746666472, -0.0143888115273171, -0.0146048632660884,...
%     -0.0147722960955923, -0.0148883484572811, -0.0149504784162407, -0.0149564120600017, -0.0149041918500886,...
%     -0.0147922237515374, -0.0146193218737855, -0.0143847493046962, -0.0140882538152739, -0.0137300971611409,...
%     -0.0133110768109214, -0.0128325390911992, -0.0122963829494099, -0.0117050537934841, -0.0110615271609512,...
%     -0.0103692822888369, -0.00963226598567076, -0.00885484753408447, -0.00804176566276414, -0.00719806890679776,...
%     -0.00632905091427362, -0.00544018244481850, -0.00453704193503916, -0.00362524657165631, -0.00271038578889415,...
%     -0.00179795940547085, -0.000893315072646318, 0]; 

%Dados obtidos para Re=10000 e HOR
ux_plot = [0, -0.00962408739919035, -0.0166806197139595, -0.0218966513053017, -0.0264090774409289, -0.0301012052855484, -0.0323717935790892, -0.0330059034012356, -0.0323691587816889, -0.0311186617692267,...
    -0.0298360899251347, -0.0288210708183898, -0.0281002283117374, -0.0275602297688021, -0.0270778761456970, -0.0265839311274458, -0.0260636787352872, -0.0255288144819462, -0.0249927139837750, -0.0244613839580874,...
    -0.0239352837595777, -0.0234132713588428, -0.0228945029865523, -0.0223785788499596, -0.0218652635372020, -0.0213543588354664, -0.0208456892597941, -0.0203390865556846, -0.0198343637451590, -0.0193313077247336,...
    -0.0188296943234188, -0.0183293082501915, -0.0178299549066581, -0.0173314636242291, -0.0168336871292972, -0.0163365000149209, -0.0158397966860543, -0.0153434887550520, -0.0148475022562341, -0.0143517750176634,...
    -0.0138562543287396, -0.0133608948723686, -0.0128656569045136, -0.0123705046704732, -0.0118754050584747, -0.0113803264685324, -0.0108852378757853, -0.0103901080650321, -0.00989490502874466, -0.00939959553821998,...
    -0.00890414493453364, -0.00840851723132852, -0.00791267566956228, -0.00741658387256432, -0.00692020766095102, -0.00642351732934708, -0.00592648974037648, -0.00542910904416939, -0.00493136443171032, -0.00443324344847757,...
    -0.00393472035738164, -0.00343574087272440, -0.00293620682176003, -0.00243596598322401, -0.00193481241093843, -0.00143250035676191, -0.000928770792957829, -0.000423384869219244, 8.38446380679268e-05, 0.000593033092939174,...
    0.00110422108551197, 0.00161738952118403, 0.00213248780340906, 0.00264946659692862, 0.00316830630111752, 0.00368903492742453, 0.00421173327931401, 0.00473652929484860, 0.00526358588836815, 0.00579308704387023,...
    0.00632522591004603, 0.00686019675232723, 0.00739819104331861, 0.00793939674262527, 0.00848399960235872, 0.00903218520911588, 0.00958414115462410, 0.0101400587211049, 0.0107001342626328, 0.0112645699850560,...
    0.0118335747018756, 0.0124073641001634, 0.0129861613585531, 0.0135701972199959, 0.0141597107989521, 0.0147549495463891, 0.0153561704914274, 0.0159636400232979, 0.0165776357958129, 0.0171984458833913,...
    0.0178263714930509, 0.0184617243923697, 0.0191048300998637, 0.0197560208581507, 0.0204156399059713, 0.0210840266640075, 0.0217615221644976, 0.0224484394333047, 0.0231450914605972, 0.0238517531414395,...
    0.0245686879426690, 0.0252959413571390, 0.0260332960983632, 0.0267799452160720, 0.0275348616732948, 0.0282968864333250, 0.0290669291896887, 0.0298494847458009, 0.0306551937908353, 0.0314957998324854,...
    0.0323782940217025, 0.0332798543384324, 0.0341635011424043, 0.0349425951953837, 0.0354438342445493, 0.0354757338068900, 0.0361861295097650, 0.0427381582757168, 0.0577350269189626...
];

uy_plot = [0, 0.0134963034606037, 0.0215856618888722, 0.0252744522877382, 0.0278420747123001, ...
0.0300917564725070, 0.0316089271567079, 0.0322944451216911, 0.0322716885578991, 0.0317323537716889, ...
0.0309320948334082, 0.0300979910621424, 0.0293432697819764, 0.0286793948282811, 0.0280753551936469, ...
0.0274982742890736, 0.0269252665702133, 0.0263453945837050, 0.0257582832826819, 0.0251684032541732, ...
0.0245794929173851, 0.0239930528091981, 0.0234093635538801, 0.0228284446168116, 0.0222503215669441, ...
0.0216750235891552, 0.0211025605470396, 0.0205329044096373, 0.0199659827053708, 0.0194016895051339, ...
0.0188399014485819, 0.0182804884279839, 0.0177233201343675, 0.0171682711552658, 0.0166152244086977, ...
0.0160640717974475, 0.0155147140752193, 0.0149670591374781, 0.0144210223945907, 0.0138765236697276, ...
0.0133334896465117, 0.0127918476277385, 0.0122515329107694, 0.0117124758778271, 0.0111746192873755, ...
0.0106378920738996, 0.0101022449538859, 0.00956760040250179, 0.00903391919986353, 0.00850111180597375, ...
0.00796915233621243, 0.00743793360796402, 0.00690744649336551, 0.00637756164639198, 0.00584828864173200, ...
0.00531947430364969, 0.00479114542457133, 0.00426312798830798, 0.00373545946422984, 0.00320795370725764, ...
0.00268064685622016, 0.00215335462316821, 0.00162609583871378, 0.00109870494999530, 0.000571166853824565, ...
4.33504590252937e-05, -0.000484806324674396, -0.00101339004515030, -0.00154251546367634, -0.00207222326512682, ...
-0.00260267719900431, -0.00313387997763415, -0.00366603207786184, -0.00419911307935388, -0.00473334281515889, ...
-0.00526869540262589, -0.00580539227621023, -0.00634341804606383, -0.00688298171936767, -0.00742408924247622, ...
-0.00796692914993663, -0.00851153318473402, -0.00905806742451072, -0.00960658830275632, -0.0101572419153719, ...
-0.0107101047624527, -0.0112653076209228, -0.0118229411607093, -0.0123831257186563, -0.0129459607002407, ...
-0.0135115600052006, -0.0140800278251690, -0.0146514746376088, -0.0152260074660717, -0.0158037360472473, ...
-0.0163847705816125, -0.0169692233226888, -0.0175572103903010, -0.0181488512134142, -0.0187442731142909, ...
-0.0193436088397148, -0.0199470031253532, -0.0205546072178533, -0.0211665861399292, -0.0217831016000593, ...
-0.0224043054771763, -0.0230302915099594, -0.0236610681371107, -0.0242964773563378, -0.0249361785521102, ...
-0.0255796820491604, -0.0262267191582305, -0.0268776979662646, -0.0275338830579314, -0.0281961164882960, ...
-0.0288615966420151, -0.0295174282846591, -0.0301317819205306, -0.0306530289406570, -0.0310544291002674, ...
-0.0314680671973450, -0.0323543964468557, -0.0344027588540953, -0.0377220560176329, -0.0404233532114932, ...
-0.0382524203238310, -0.0279799515681100, -0.0128762219268668, 0];


% Dados obtidos para Re=10000 e Segunda ordem
ux_plot2 = [0, -0.0127936372666994, -0.0211151949035645, -0.0257678735957876, -0.0287415911302714, ...  
-0.0306459531357004, -0.0312964946320107, -0.0308829985123724, -0.0299213399030835, -0.0288559157151946, ...  
-0.0279347511394614, -0.0272240553939137, -0.0266636004698065, -0.0261552520903404, -0.0256341074188245, ...  
-0.0250836714522395, -0.0245143929515490, -0.0239403224625161, -0.0233689426817563, -0.0228015995614284, ...  
-0.0222374155419580, -0.0216758713952554, -0.0211171258440235, -0.0205614094825727, -0.0200087434397821, ...  
-0.0194591085837700, -0.0189126420080711, -0.0183696324385636, -0.0178304062929030, -0.0172952481235454, ...  
-0.0167643912499577, -0.0162380364111443, -0.0157163624050568, -0.0151995248714069, -0.0146876539266203, ...  
-0.0141808557073521, -0.0136792155478322, -0.0131827995865228, -0.0126916545531812, -0.0122058071089263, ...  
-0.0117252636532445, -0.0112500105617776, -0.0107800145715925, -0.0103152232523934, -0.00985556563687542, ...  
-0.00940095301959350, -0.00895127982847728, -0.00850642448526810, -0.00806625023898194, -0.00763060605228013, ...  
-0.00719932767090701, -0.00677223904326779, -0.00634915419793750, -0.00592987953880282, -0.00551421619908363, ...  
-0.00510196171813079, -0.00469290992786289, -0.00428684784798037, -0.00388354870193916, -0.00348276109974024, ...  
-0.00308419575668875, -0.00268751260011163, -0.00229231204711244, -0.00189813427720658, -0.00150446894375201, ...  
-0.00111077540241838, -0.000716510537781733, -0.000321158870920679, 7.57416785934828e-05, 0.000474584185967154, ...  
0.000875690859252608, 0.00127932494603404, 0.00168571323587650, 0.00209507340100211, 0.00250764013212969, ...  
0.00292368473434030, 0.00334352551203187, 0.00376752846706443, 0.00419610053712504, 0.00462967811140451, ...  
0.00506871450904603, 0.00551366850317256, 0.00596499592759488, 0.00642314409243524, 0.00688854942572940, ...  
0.00736163660171166, 0.00784281941728378, 0.00833250145096901, 0.00883107763465600, 0.00933893476537139, ...  
0.00985645309012071, 0.0103840065296074, 0.0109219645565785, 0.0114706922601839, 0.0120305526157714, ...  
0.0126019060356157, 0.0131851127263226, 0.0137805311430142, 0.0143885202157592, 0.0150094361020745, ...  
0.0156436340754266, 0.0162914632525381, 0.0169532689200239, 0.0176293850576828, 0.0183201363603490, ...  
0.0190258275475479, 0.0197467495009527, 0.0204831723409006, 0.0212353638021534, 0.0220035971928619, ...  
0.0227881971037561, 0.0235895308171964, 0.0244079904218775, 0.0252439264950196, 0.0260977507077377, ...  
0.0269705567929912, 0.0278658019981037, 0.0287898353957474, 0.0297487664463673, 0.0307437482817137, ...  
0.0317545508483362, 0.0327032625394560, 0.0334786675508185, 0.0339653054862981, 0.0338445554474273, ...  
0.0331369201015228, 0.0346340956290320, 0.0430636012470378, 0.0577350269189626];  



uy_plot2 = [ 0, 0.0129658112207862, 0.0221067576510751, 0.0274910160535459, 0.0301010237330885, ...  
            0.0313300350693955, 0.0318306466792307, 0.0317169775457664, 0.0311332188513949, 0.0303287244129603, ...  
            0.0294887246573373, 0.0286884430524893, 0.0279443264117127, 0.0272488825464240, 0.0265834498610012, ...  
            0.0259303064497493, 0.0252805972313126, 0.0246332103803896, 0.0239898916508206, 0.0233520709808250, ...  
            0.0227201575342313, 0.0220939538361446, 0.0214731554429072, 0.0208575857707993, 0.0202472174383923, ...  
            0.0196421171330874, 0.0190424002203622, 0.0184482056103767, 0.0178596830350779, 0.0172769809513663, ...  
            0.0167002370925162, 0.0161295722845216, 0.0155650905293814, 0.0150068793901570, 0.0144550119729624, ...  
            0.0139095438607437, 0.0133705151313276, 0.0128379439706194, 0.0123118339913261, 0.0117921622425325, ...  
            0.0112788964266170, 0.0107719706435101, 0.0102713199498092, 0.00977683369099511, 0.00928841898165393, ...  
            0.00880591734506049, 0.00832921302307682, 0.00785809531799832, 0.00739243074350214, 0.00693195218159724, ...  
            0.00647651346446089, 0.00602578915801722, 0.00557962451052118, 0.00513763799828663, 0.00469966789183521, ...  
            0.00426528398958649, 0.00383431512200469, 0.00340629507424908, 0.00298103606468422, 0.00255805286859912, ...  
            0.00213713009803520, 0.00171778300608855, 0.00129975619439880, 0.000882584631014686, 0.000465962257104973, ...  
            4.94595770825655e-05, -0.000367286077364624, -0.000784659009105074, -0.00120307759900688, -0.00162287877368367, ...  
           -0.00204452806386058, -0.00246831973504501, -0.00289475116252587, -0.00332408361668712, -0.00375682692970944, ...  
           -0.00419322136355494, -0.00463376943983211, -0.00507870206763364, -0.00552849785053832, -0.00598338757304131, ...  
           -0.00644381480838205, -0.00691001568759560, -0.00738239353365339, -0.00786119079453496, -0.00834676952560891, ...  
           -0.00883937460125767, -0.00933932712505526, -0.00984686599961477, -0.0103622707524618, -0.0108857632392863, ...  
           -0.0114175797555927, -0.0119579146653869, -0.0125069601080882, -0.0130648764255169, -0.0136318136062455, ...  
           -0.0142078972549059, -0.0147932401309675, -0.0153879352040797, -0.0159920622143352, -0.0166056840918373, ...  
           -0.0172288488874002, -0.0178615802571918, -0.0185038734627007, -0.0191556950326843, -0.0198169916857482, ...  
           -0.0204876697549156, -0.0211675568851529, -0.0218564295704716, -0.0225541907305966, -0.0232609967535286, ...  
           -0.0239770773903834, -0.0247026922273313, -0.0254391690322544, -0.0261897375348123, -0.0269560380691090, ...  
           -0.0277315372369663, -0.0285044880398623, -0.0292709166169406, -0.0300183523327450, -0.0306757389700534, ...  
           -0.0311996462451679, -0.0319519237751345, -0.0338539294358549, -0.0371829267135215, -0.0395854161224780, ...  
           -0.0368698630618392, -0.0271579864134892, -0.0135029352042067, 0 ];

% 

% GENERAL FLOW CONSTANTS 
lx = 129; 
ly = lx; 

uLid  = .1/sqrt(3); % horizontal lid velocity 
vLid  = 0;    % vertical lid velocity 
Re    = 10000;  % Reynolds number 100 or 10000
maxT  = 10000000; % total number of iterations 500000
tPlot = 1000;    % cycles for graphical output4000

% % VISUALIZATION
   figure
   % % Plotar os dados de Regularização de alta ordem  
     plot(ux_plot/uLid/2, (0:ly-1)/(ly-1)-.5,'-.');
     hold on
     plot((0:lx-1)/(lx-1)-.5, uy_plot/uLid/2,'-.');
     % % Plotar os dados de referência de Ghia
     plot(u_ghia / 2, y_ghia - .5, 'o');  % Velocidade u
     plot(x_ghia - .5, v_ghia / 2, 'o');  % Velocidade v
     % % Plotar dados de Regularização de segunda ordem
     plot(ux_plot2/uLid/2, (0:ly-1)/(ly-1)-.5,'-');
     plot((0:lx-1)/(lx-1)-.5, uy_plot2/uLid/2,'-');
     title('Velocidade nas Linhas Centrais')
     axis([-0.5 0.5 -0.5 0.5]);
     axis square      
     hold off

    % Configurações do gráfico
    title('Velocidade nas Linhas Centrais');
    xlabel('Coordenada Normalizada');
    ylabel('Velocidade Normalizada');
    legend({'HOR', '2ª Ordem', 'Ghia et al.'}, ...
       'Location', 'best');
    drawnow     


save ldcRe1e4L065hor
savefig('plotghia')